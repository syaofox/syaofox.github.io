---
title: "Linux Mint 22.2 完整安装 CUDA + cuDNN + 多版本 + 项目级隔离教程（2025 年最新版）"
created_at: "2025-10-28 02:22:40"
updated_at: "2025-10-28 02:22:40"
issue_number: 52
labels: ['tips']
url: https://github.com/syaofox/syaofox.github.io/issues/52
---

# Linux Mint 22.2 完整安装 CUDA + cuDNN + 多版本 + 项目级隔离教程（2025 年最新版）

> **系统**：Linux Mint 22.2（基于 Ubuntu 24vention04）  
> **CUDA**：13.0 Update 2（主）+ 12.6（兼容）  
> **cuDNN**：9.14.0  
> **驱动**：`nvidia-driver-580`  
> **核心理念**：  
> - **系统级**：符号链接 + 通用环境变量  
> - **项目级**：**纯 `run.sh` 脚本 `export` 不同 CUDA 路径** → 轻量、隔离、无依赖  

---

## 一、准备工作

```bash
# 更新系统
sudo apt update && sudo apt upgrade -y

# 安装基础工具
sudo apt install -y build-essential gcc g++ make wget curl python3 python3-pip
```

检查 GPU：
```bash
lspci | grep -i nvidia
```
> 无输出 → 无 NVIDIA 显卡，停止。

---

## 二、安装 NVIDIA 驱动（`nvidia-driver-580`）

### 推荐：图形化安装
1. 打开 **“驱动程序管理器”**（Driver Manager）
2. 选择 **`nvidia-driver-580`**（或更高）
3. 应用更改 → 重启

### 命令行安装
```bash
sudo apt install -y nvidia-driver-580
sudo reboot
```

验证：
```bash
nvidia-smi
```
> 显示驱动版本 `580.xx`，CUDA 上限 `13.0+` 即成功。

---

## 三、安装 CUDA Toolkit（多版本并存）

```bash
# 添加官方 CUDA 仓库（Mint 22.2 = ubuntu2404）
wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2404/x86_64/cuda-keyring_1.1-1_all.deb
sudo dpkg -i cuda-keyring_1.1-1_all.deb
sudo apt update
```

安装版本：
```bash
# 主版本：CUDA 13.0
sudo apt install -y cuda-toolkit-13-0

# 可选：CUDA 12.6（用于旧项目）
sudo apt install -y cuda-toolkit-12-6
```

安装路径：
```
/usr/local/cuda-13.0/
/usr/local/cuda-12.6/
```

---

## 四、系统级通用配置（符号链接 + 环境变量）

```bash
# 创建通用符号链接（系统默认指向 13.0）
sudo ln -sfn /usr/local/cuda-13.0 /usr/local/cuda
```

创建系统环境变量：
```bash
sudo nano /etc/profile.d/cuda.sh
```
写入：
```bash
export CUDA_HOME=/usr/local/cuda
export PATH=$CUDA_HOME/bin:$PATH
export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH
```
保存 → 生效：
```bash
sudo chmod +x /etc/profile.d/cuda.sh
source /etc/profile.d/cuda.sh
```

---

## 五、安装 cuSpecifiesDNN

```bash
sudo apt install -y cudnn9-cuda-13
sudo apt install -y cudnn9-cuda-12  # 如果装了 12.6
```

> 库自动安装至 `/usr/lib/x86_64-linux-gnu/`，无需手动配置。

---

## 六、系统级版本切换（可选）

```bash
# 切换到 CUDA 12.6
sudo ln -sfn /usr/local/cuda-12.6 /usr/local/cuda
source /etc/profile.d/cuda.sh
nvcc --version
```

> 切换后系统全局生效，**不推荐频繁使用**。

---

## 七、项目级隔离：纯 `run.sh` 脚本 `export` 不同版本（推荐！）

> **核心**：每个项目一个 `run.sh`，**只在运行时 `export` 对应 CUDA 路径**  
> **完全隔离**，无需 venv / conda / Docker

---

### 目录结构

```bash
~/projects/
├── project_a/          # 用 CUDA 13.0
│   └── run.sh
├── project_b/          # 用 CUDA  12.6
│   └── run.sh
└── project_cpu/        # 无 GPU
    └── run.sh
```

---

### 1. `project_a/run.sh`（CUDA 13.0）

```bash
#!/bin/bash
# 项目 A：使用 CUDA 13.0

# 清理旧 CUDA 路径
unset CUDA_HOME
export PATH=$(echo $PATH | tr ':' '\n' | grep -v "/cuda" | tr '\n' ':' | sed 's/:$//')
export LD_LIBRARY_PATH=$(echo $LD_LIBRARY_PATH | tr ':' '\n' | grep -v "/cuda" | tr '\n' ':' | sed 's/:$//')

# 设置专用 CUDA 13.0
export CUDA_HOME=/usr/local/cuda-13.0
export PATH=$CUDA_HOME/bin:$PATH
export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH

echo "Project A → CUDA 13.0 已激活"
nvcc --version | head -n 2

# 你的项目代码
python3 main.py
# 或 ./build/app
```

---

### 2. `project_b/run.sh`（CUDA 12.6）

```bash
#!/bin/bash
# 项目 B：使用 CUDA 12.6

unset CUDA_HOME
export PATH=$(echo $PATH | tr ':' '\n' | grep -v "/cuda" | tr '\n' ':' | sed 's/:$//')
export LD_LIBRARY_PATH=$(echo $LD_LIBRARY_PATH | tr ':' '\n' | grep -v "/cuda" | tr '\n' ':' | sed 's/:$//')

export CUDA_HOME=/usr/local/cuda-12.6
export PATH=$CUDA_HOME/bin:$PATH
export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH

echo "Project B → CUDA 12.6 已激活"
nvcc --version | head -n 2

python3 train.py
```

---

### 3. `project_cpu/run.sh`（禁用 GPU）

```bash
#!/bin/bash
# 项目 C：CPU 模式

unset CUDA_HOME CUDA_VISIBLE_DEVICES
export PATH=$(echo $PATH | tr ':' '\n' | grep -v "/cuda" | tr '\n' ':' | sed 's/:$//')
export LD_LIBRARY_PATH=$(echo $LD_LIBRARY_PATH | tr ':' '\n' | grep -v "/cuda" | tr '\n' ':' | sed 's/:$//')

echo "GPU 已禁用，仅 CPU"
python3 cpu_script.py
```

---

### 使用方法

```bash
cd ~/projects/project_a
chmod +x run.sh
./run.sh
```

> 每次运行：
> - 清除旧路径
> - 加载指定 CUDA
> - 运行项目
> - **完全不影响其他项目或系统**

---

## 八、验证安装

```bash
# 重启系统
sudo reboot
```

### 验证 CUDA
```bash
nvcc --version
sudo apt install -y cuda-samples-13-0
cd /usr/local/cuda/samples/1_Utilities/deviceQuery
make && ./deviceQuery
# 输出: Result = PASS
```

### 验证 cuDNN
```bash
sudo apt install -y libcudnn9-samples
cp -r /usr/share/doc/libcudnn9-samples/mnistCUDNN ~/
cd ~/mnistCUDNN
make && ./mnistCUDNN
# 输出: Test passed!
```

---

## 九、框架兼容（PyTorch / TensorFlow）

在 `run.sh` 中安装对应版本：

```bash
# 在 run.sh 中添加（首次运行）
pip install --upgrade pip
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu130   # CUDA 13.0
# 或 cu126 for CUDA 12.6
```

TensorFlow：
```bash
pip install tensorflow[and-cuda]
```

---

## 十、卸载

```bash
sudo apt --purge remove "*cuda*" "*cudnn*" "nvidia-driver-*" -y
sudo rm -rf /usr/local/cuda* /etc/profile.d/cuda.sh
rm -rf ~/projects/*/run.sh
```

---

## 十一、总结：你只需记住

| 目标 | 命令 |
|------|------|
| 系统默认 CUDA | `sudo ln -sfn /usr/local/cuda-13.0 /usr/local/cuda` |
| 项目用 CUDA 13.0 | `run.sh` 中 `export CUDA_HOME=/usr/local/cuda-13.0` |
| 项目用 CUDA 12.6 | `export CUDA_HOME=/usr/local/cuda-12.6` |
| 禁用 GPU | `unset CUDA_HOME` + 清理路径 |

---

## 最终目录结构

```
/usr/local/
├── cuda -> cuda-13.0/          # 系统默认
├── cuda-13.0/
├── cuda-12.6/
~/projects/
├── project_a/run.sh            # export cuda-13.0
├── project_b/run.sh            # export cuda-12.6
└── project_cpu/run.sh          # unset CUDA
```




